{% extends 'base.html.twig' %}

{% block title %}Signalement des Inscrits
{% endblock %}

{% block body %}
	<div class="min-h-screen bg-slate-50 py-12 px-4 sm:px-6 lg:px-8">
		<div class="max-w-2xl mx-auto">
			<div class="text-center mb-10">
				<h1 class="text-3xl font-extrabold text-slate-900">
					Participation Citoyenne
				</h1>
				<p class="mt-2 text-lg text-slate-600">
					Aidez-nous à consolider la carte électorale en signalant le nombre d'inscrits de votre centre.
				</p>
			</div>

			<div class="bg-white py-8 px-6 shadow-xl rounded-2xl sm:px-10 border border-slate-100" data-controller="signalement">

				{{ form_start(form, {'attr': {'class': 'space-y-6'}}) }}

				{# Nom #}
				<div>
					{{ form_label(form.auteurNom, null, {'label_attr': {'class': 'block text-sm font-medium text-slate-700'}}) }}
					<div class="mt-1">
						{{ form_widget(form.auteurNom, {'attr': {'class': 'appearance-none block w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm placeholder-slate-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm'}}) }}
					</div>
					{{ form_errors(form.auteurNom) }}
				</div>

				{# Centre de Vote (Recherche Autocomplete) #}
				<div class="relative">
					<label class="block text-sm font-medium text-slate-700 mb-1">Centre de Vote</label>
					<div class="relative">
						<input
						type="text" class="appearance-none block w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm" placeholder="Tapez le nom de votre centre ou commune..." data-signalement-target="searchInput" data-action="input->signalement#onSearchInput" autocomplete="off">
						{# Résultats de recherche #}
						<div
							data-signalement-target="searchResults" class="absolute z-10 w-full mt-1 bg-white shadow-lg max-h-60 rounded-md py-1 text-base ring-1 ring-black ring-opacity-5 overflow-auto focus:outline-none sm:text-sm hidden"><!-- JS will populate this -->
						</div>
					</div>

					<p class="mt-1 text-xs text-slate-500">Sélectionnez votre centre dans la liste qui apparaît.</p>

					{# Input Hidden pour l'ID #}
					<div class="hidden">
						{{ form_widget(form.centreId) }}
					</div>
					{{ form_errors(form.centreId) }}
				</div>

				{# Total Inscrits #}
				<div>
					{{ form_label(form.nombreInscritsTotal, null, {'label_attr': {'class': 'block text-sm font-medium text-slate-700'}}) }}
					<div class="mt-1">
						{{ form_widget(form.nombreInscritsTotal, {
                            'attr': {
                                'class': 'appearance-none block w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm',
                                'data-signalement-target': 'totalInput'
                            }
                        }) }}
					</div>
				</div>

				{# Zone Dynamique des Bureaux #}
				<div data-signalement-target="bureauxContainer" class="bg-slate-50 p-4 rounded-lg border border-dashed border-slate-300 min-h-[100px]">
					<div class="text-center text-slate-400 text-sm mt-4">
						Sélectionnez un centre de vote ci-dessus pour afficher le détail des postes.
					</div>
				</div>

				{# Champ caché JSON #}
				<div class="hidden">
					{{ form_widget(form.repartitionBureauxJson, {'attr': {'data-signalement-target': 'jsonInput'}}) }}
				</div>

				{# Preuve Image #}
				<div>
					<label class="block text-sm font-medium text-slate-700 mb-2">Preuve Photo (Liste électorale affichée)</label>
					<div class="mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-slate-300 border-dashed rounded-md hover:bg-slate-50 transition-colors cursor-pointer relative">
						<div class="space-y-1 text-center">
							<i class="fas fa-camera text-4xl text-slate-400 mb-3"></i>
							<div class="flex text-sm text-slate-600 justify-center">
								<label for="{{ form.preuveImageFile.vars.id }}" class="relative cursor-pointer bg-white rounded-md font-medium text-blue-600 hover:text-blue-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-blue-500">
									<span>Télécharger une photo</span>
									{{ form_widget(form.preuveImageFile, {'attr': {'class': 'sr-only'}}) }}
								</label>
							</div>
							<p class="text-xs text-slate-500">PNG, JPG, WEBP jusqu'à 10MB</p>
						</div>
					</div>
					{{ form_errors(form.preuveImageFile) }}
				</div>

				<div class="pt-4">
					<button type="submit" class="w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-benin-green hover:bg-benin-green/80 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-benin-green transition-all font-bold text-lg">
						<i class="fas fa-paper-plane mr-2 mt-1"></i>
						Envoyer le Signalement
					</button>
				</div>

				{{ form_end(form) }}
			</div>
		</div>
	</div>
{% endblock %}
