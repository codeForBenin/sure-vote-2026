<nav class="bg-white border-b border-slate-100 relative z-50" data-controller="mobile-menu">
	<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">

		<div class="flex justify-between items-center h-20">

			<!-- LOGO AREA -->
			<div class="flex items-center shrink-0">
				<a href="{{ path('app_home') }}" class="flex items-center gap-2 text-2xl font-black text-slate-900 tracking-tighter hover:opacity-80 transition-opacity">
					<img src="{{ asset('uploads/metadata/favicon.png') }}" alt="Logo SureVote" class="w-10 h-10 md:w-12 md:h-12 object-contain mr-2 rounded-full">
					<span>
						SURE<span class="text-benin-green">VOTE</span>
					</span>
				</a>

				{% if is_granted('IS_AUTHENTICATED_FULLY') and is_granted('ROLE_ASSESSEUR') and app.request.attributes.get('_route') == 'app_assesseur_dashboard' %}
					<span class="hidden md:inline-block ml-4 px-2 py-1 bg-benin-green/10 text-benin-green text-xs font-bold rounded uppercase">Espace Assesseur</span>
				{% endif %}
			</div>

			<!-- MOBILE MENU BUTTON -->
			<div class="flex md:hidden">
				<button type="button" data-action="click->mobile-menu#toggle" class="text-slate-500 hover:text-benin-green focus:outline-none p-2 rounded-md">
					<span data-mobile-menu-target="iconOpen"><i class="fas fa-bars text-2xl"></i></span>
					<span class="hidden" data-mobile-menu-target="iconClose"><i class="fas fa-times text-2xl"></i></span>
				</button>
			</div>

			<!-- NAVIGATION LINKS -->
			<div 
                data-mobile-menu-target="menu" 
                class="hidden md:flex flex-col md:flex-row absolute md:static top-full left-0 w-full md:w-auto bg-white md:bg-transparent border-b md:border-0 border-slate-100 shadow-xl md:shadow-none p-6 md:p-0 gap-4 md:gap-6 md:items-center transition-all origin-top">

				{% if is_granted('IS_AUTHENTICATED_FULLY') %}
					{# --- MENU CONNECTÉ : ÉPURÉ --- #}
					<a href="{{ path('app_home') }}" class="text-base md:text-sm font-bold text-slate-500 hover:text-benin-green transition-colors py-2 md:py-0">
						Accueil
					</a>

					{% set dashboard_path = is_granted('ROLE_ADMIN') ? path('admin') : path('app_assesseur_dashboard') %}
					{% set dashboard_label = is_granted('ROLE_ADMIN') ? 'Espace Administrateur' : 'Tableau de Bord' %}

					{% if app.request.attributes.get('_route') != 'app_assesseur_dashboard' and app.request.attributes.get('_route') != 'admin' %}
						<a href="{{ dashboard_path }}" class="text-base md:text-sm font-bold text-benin-green hover:text-green-700 transition-colors py-2 md:py-0">
							{{ dashboard_label }}
						</a>
					{% else %}
						{# On est déjà sur le dashboard #}
						<span class="text-xs font-bold text-slate-400 uppercase py-2 md:py-0">{{ app.user.fullName }}</span>
					{% endif %}

					<a href="{{ path('app_logout') }}" class="inline-block text-center bg-red-50 text-red-600 px-4 py-2 rounded-xl text-sm font-bold hover:bg-red-100 transition-colors mt-2 md:mt-0">
						Déconnexion
					</a>

				{% else %}
					{# --- MENU PUBLIC : COMPLET --- #}

					{% if app.request.attributes.get('_route') != 'app_home' %}
						<a href="{{ path('app_home') }}" class="text-base md:text-sm font-bold text-slate-500 hover:text-benin-green transition-colors py-2 md:py-0 block">
							{{ 'menu.home'|trans }}
						</a>
					{% endif %}

					{% if app.request.attributes.get('_route') != 'app_public_resultats_search' %}
						<a href="{{ path('app_public_resultats_search') }}" class="text-base md:text-sm font-bold text-slate-500 hover:text-benin-green transition-colors py-2 md:py-0 block">
							<i class="fas fa-search mr-1 md:hidden lg:inline"></i>
							{{ 'menu.find_center'|trans }}
						</a>
					{% endif %}

					{% if app.request.attributes.get('_route') != 'app_stats_participation' %}
						<a href="{{ path('app_stats_participation') }}" class="text-base md:text-sm font-bold text-slate-500 hover:text-benin-green transition-colors py-2 md:py-0 block">
							{{ 'menu.stats'|trans }}
						</a>
					{% endif %}

					{% if app.request.attributes.get('_route') != 'app_projections' %}
						<a href="{{ path('app_projections') }}" class="text-base md:text-sm font-bold text-slate-500 hover:text-benin-green transition-colors py-2 md:py-0 block">
							{{ 'menu.projections'|trans }}
						</a>
					{% endif %}
                    
                    {# Stats Parlement Link (New) #}
                    {% if app.request.attributes.get('_route') != 'app_stats_parlement' %}
						<a href="{{ path('app_stats_parlement') }}" class="text-base md:text-sm font-bold text-slate-500 hover:text-benin-green transition-colors py-2 md:py-0 block">
							<i class="fas fa-landmark mr-1 md:hidden lg:inline"></i>
							Hémicycle
						</a>
					{% endif %}

					{% if app.request.attributes.get('_route') != 'app_infos' %}
						<a href="{{ path('app_infos') }}" class="text-base md:text-sm font-bold text-benin-green hover:text-green-700 transition-colors flex items-center gap-2 py-2 md:py-0">
							<i class="fas fa-info-circle"></i>
							{{ 'menu.infos'|trans }}
						</a>
					{% endif %}

					<a href="{{ path('app_login') }}" class="text-base md:text-sm font-semibold text-slate-600 hover:text-benin-green transition-colors py-2 md:py-0 block">{{ 'menu.login'|trans }}</a>

				{% endif %}
          
				{# Language Switcher #}
				<div class="border-t md:border-t-0 md:border-l border-slate-200 mt-4 md:mt-0 pt-4 md:pt-0 md:pl-4 flex items-center gap-3 md:gap-2">
					<a href="{{ path('change_locale', {locale: 'fr'}) }}" class="text-sm md:text-xs font-bold {{ app.request.locale == 'fr' ? 'text-slate-900 bg-slate-100 px-2 py-1 rounded' : 'text-slate-400 hover:text-slate-600' }}">FR</a>
					<span class="text-slate-300 hidden md:inline">|</span>
					<a href="{{ path('change_locale', {locale: 'en'}) }}" class="text-sm md:text-xs font-bold {{ app.request.locale == 'en' ? 'text-slate-900 bg-slate-100 px-2 py-1 rounded' : 'text-slate-400 hover:text-slate-600' }}">EN</a>
				</div>

			</div>
		</div>
	</div>
</nav>
