{% extends 'base.html.twig' %}

{% block title %}Trouver mon centre de vote - Sure Vote
{% endblock %}

{% block body %}
	<div class="min-h-screen bg-slate-50 py-12">
		<div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8">

			<div class="text-center mb-12">
				<h1 class="text-4xl font-black text-slate-900 mb-4">Trouver votre centre de vote</h1>
				<p class="text-lg text-slate-500">Commencez par taper votre arrondissement, quartier ou le nom de votre centre de vote pour consulter les résultats des postes de vote de votre centre de vote.</p>


			</div>

			<div class="bg-white rounded-2xl shadow-xl p-8 mb-8 border border-slate-100">
				<form action="{{ path('app_public_resultats_search') }}" method="get" class="relative">
					<div class="relative" data-controller="search-preview" data-search-preview-url-value="{{ path('app_public_resultats_suggestions') }}">

						<div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
							<i class="fas fa-search text-slate-400 text-xl"></i>
						</div>
						<input
						type="text" name="q" value="{{ query }}" class="block w-full pl-12 pr-4 py-4 bg-slate-50 border-transparent text-slate-900 placeholder-slate-400 focus:bg-white focus:border-benin-green focus:ring-benin-green rounded-xl text-lg font-medium transition-all" placeholder="Ex: Cotonou, Godomey, nom d'école..." autocomplete="off" data-search-preview-target="input" data-action="input->search-preview#onInput focus->search-preview#onInput">


						{# Results container #}
						<div data-search-preview-target="results"></div>

					</div>
					<button type="submit" class="absolute right-2 top-2 bottom-2 px-4 sm:px-6 bg-benin-green hover:bg-benin-green/90 text-white font-bold rounded-lg transition-colors z-20">
						<span class="sm:hidden">
							<i class="fas fa-search"></i>
						</span>
						<span class="hidden sm:inline">Rechercher</span>
					</button>
				</form>
			</div>

			{% if query %}
				<div class="space-y-4">
					<div class="flex items-center justify-between mb-6">
						<h2 class="text-xl font-bold text-slate-800">Résultats de recherche</h2>
						<span class="text-sm font-medium text-slate-500">{{ centres|length }}
							centre(s) trouvé(s)</span>

					</div>

					{% if centres is empty %}

						<div class="text-center py-12 bg-white rounded-2xl border border-slate-100 border-dashed">
							<div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-slate-50 mb-4">
								<i class="fas fa-search-minus text-slate-400 text-2xl"></i>
							</div>
							<h3 class="text-lg font-bold text-slate-900 mb-1">Aucun centre trouvé pour "{{ query }}"</h3>

							<p class="text-slate-500">Essayez avec le nom de votre arrondissement ou centre de vote.</p>
						</div>
					{% else %}
						<div class="grid gap-6">
							{% for centre in centres %}

								{% set circo = centre.circonscription %}
								<div class="bg-white rounded-xl border border-slate-100 shadow p-6 hover:shadow-lg transition-shadow">
									<div class="mb-4">
										<div class="flex items-center gap-2 mb-1">
											<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-bold bg-benin-green/10 text-benin-green">
												{{ centre.code }}
											</span>
											<span class="text-xs font-medium text-slate-400">
												<i class="fas fa-map-marker-alt text-[10px] mr-1"></i>

												{{ centre.arrondissement|default(circo.nom) }}
												<span class="text-slate-300 mx-1">•</span>
												{{ centre.commune|default('') }}</span>
										</div>

										<h3 class="text-lg font-bold text-slate-900">
											{{ centre.nom }}

										</h3>
										{% if centre.villageQuartier %}
											<p class="text-sm text-slate-500 mt-1">
												<strong>Quartier / Village :
												</strong>
												{{ centre.villageQuartier }}
											</p>
										{% endif %}

									</div>

									<div class="border-t border-slate-100 pt-4">
										<h4 class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-3">Postes de vote</h4>
										<div class="grid sm:grid-cols-2 gap-3">
											{% for bureau in centre.bureaux %}
												<a href="{{ path('app_public_resultats_show', {id: bureau.id}) }}" class="flex items-center justify-between bg-slate-50 hover:bg-slate-100 p-3 rounded-lg border border-slate-200 hover:border-benin-green/50 transition-colors group">
													<div class="flex items-center gap-2">
														<i class="fas fa-vote-yea text-slate-400 group-hover:text-benin-green transition-colors"></i>
														<span class="text-sm font-bold text-slate-700">{{ bureau.nom }}</span>
													</div>
													<i class="fas fa-chevron-right text-xs text-slate-300 group-hover:text-benin-green"></i>
												</a>
											{% else %}
												<p class="text-sm text-slate-400 italic">Aucun poste de vote importé.</p>
											{% endfor %}

										</div>
									</div>
								</div>

							{% endfor %}
						</div>
					{% endif %}
				</div>
			{% endif %}
		</div>
	</div>
{% endblock %}
